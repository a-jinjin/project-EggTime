<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./css/class.css" />

    <style>
      #root {
        width: 100vw;
        height: 100vh;
        background: url(./img/tile-bg.svg);
        background-size: cover;
        background-position: center top;
        background-repeat: no-repeat;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #waterfall {
        width: 40vw;
        height: 53vh;
        background-image: url(./img/water-fall.svg);
        background-position: center top;
        background-repeat: no-repeat;
        position: absolute;
        z-index: 4;
      }
    </style>
  </head>

  <body>
    <div id="root">
      <div class="timer"></div>
      <div class="egg">
        <img src="./img/egg-spa.svg" alt="" />
      </div>
      <div class="water"></div>
    </div>

    <script>
      const root = document.getElementById("root");
      const timer = document.querySelector(".timer");
      const egg = document.querySelector(".egg");
      const water = document.querySelector(".water");
      // console.log(timer);

      const loadImg = document.createElement("div");
      loadImg.style.width = 100 + "vw";
      loadImg.style.height = 100 + "vh";
      loadImg.style.backgroundImage = "url(../img/loading-bg.svg)";
      loadImg.style.backgroundSize = "cover";
      loadImg.style.backgroundPosition = "center top";
      loadImg.style.backgroundRepeat = "no-repeat";
      loadImg.style.position = "absolute";
      loadImg.style.zIndex = 5;
      root.appendChild(loadImg);

      let loadI = 0;
      const loadTimer = setInterval(() => {
        loadI++;
        console.log(loadI);
        if (loadI === 5) {
          clearInterval(loadTimer);
          loadImg.remove();
        }
      }, 1000);

      // timer를 위한 변수들
      let eggTime = 5;
      let timeMin = "";
      let timeSec = "";
      const timeTxt = document.createElement("h1");
      timer.appendChild(timeTxt);
      timeMin = parseInt(eggTime / 60);
      timeSec = eggTime % 60;
      // timeTxt.textContent = `0${timeMin} : 0${timeSec}`;
      timeTxt.textContent = `START`;
      timeTxt.style.color = "#BF1010";

      timer.addEventListener("click", function () {
        timeTxt.textContent = `0${timeMin} : 0${timeSec}`;

        const showerTime = setInterval(() => {
          eggTime = eggTime - 1;
          timeMin = parseInt(eggTime / 60);
          timeSec = eggTime % 60;

          if (timeSec < 10) {
            timeTxt.textContent = `0${timeMin} : 0${timeSec}`;
          } else {
            timeTxt.textContent = `0${timeMin} : ${timeSec}`;
          }

          if (eggTime <= 0) {
            clearInterval(showerTime);

            alert("~~찬물샤워시간~~");

            // timer 사라지게
            timer.style.display = "none";

            // water 왼쪽으로 옮기기
            let waterI = 0;
            const waterMove = setInterval(() => {
              waterI = waterI - 10;
              water.style.transform = `translateX(${waterI}vw)`;
              if (waterI === -100) {
                clearInterval(waterMove);
                waterI = 0;
              }
            }, 25);

            // egg 이미지 바꿔주기
            // console.dir(egg.children[0])
            egg.children[0].src = "./img/egg-shawer.svg";

            // 의자
            const chair = document.createElement("div");
            root.appendChild(chair);
            chair.classList.add("chair");
            chair.id = "eggChair";
            // consol;e.log(root.children);
            const eggChair = document.getElementById("eggChair");

            let chairI = 0;
            const chairMove = setInterval(() => {
              chairI = chairI + 1;
              eggChair.style.bottom = `${chairI}vh`;

              if (chairI >= 20) {
                clearInterval(chairMove);
              }
            }, 10);

            // 샤워기
            const waterfall = document.createElement("div");
            root.appendChild(waterfall);
            waterfall.id = "waterfall";
            const waterfallShower = document.getElementById("waterfall");

            let waterfallI = -70;
            const waterFallMove = setInterval(() => {
              waterfallI = waterfallI + 1;
              waterfallShower.style.top = `${waterfallI}vh`;

              if (waterfallI === -1) {
                clearInterval(waterFallMove);
              }
            }, 1);
          }
        }, 1000);
      });
    </script>
  </body>
</html>
